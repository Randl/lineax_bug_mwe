HloModule jit__lambda_, entry_computation_layout={(c128[3]{0})->(c128[3]{0}, c128[3]{0})}, allow_spmd_sharding_propagation_to_output={true,true}

%fused_computation (param_0: c128[3], param_1.2: c128[3], param_2.1: c128[]) -> c128[3] {
  %param_0 = c128[3]{0} parameter(0)
  %param_2.1 = c128[] parameter(2)
  %broadcast.67 = c128[3]{0} broadcast(c128[] %param_2.1), dimensions={}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.2 = c128[3]{0} parameter(1)
  %multiply.95 = c128[3]{0} multiply(c128[3]{0} %broadcast.67, c128[3]{0} %param_1.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %add.96 = c128[3]{0} add(c128[3]{0} %param_0, c128[3]{0} %multiply.95), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.1 (param_0.2: c128[3]) -> c128[] {
  %param_0.2 = c128[3]{0} parameter(0)
  %real.104 = f64[3]{0} real(c128[3]{0} %param_0.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.104 = f64[3]{0} imag(c128[3]{0} %param_0.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.74 = f64[3]{0} negate(f64[3]{0} %imag.104), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.72 = c128[3]{0} complex(f64[3]{0} %real.104, f64[3]{0} %negate.74), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %dot.120 = c128[] dot(c128[3]{0} %complex.72, c128[3]{0} %param_0.2), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.2 (param_0.3: c128[3], param_1.9: c128[3], param_2.8: c128[3]) -> c128[3] {
  %param_0.3 = c128[3]{0} parameter(0)
  %param_2.8 = c128[3]{0} parameter(2)
  %constant.57..sunk.3 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.96 = c128[3]{0} multiply(c128[3]{0} %param_2.8, c128[3]{0} %constant.57..sunk.3), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %param_1.9 = c128[3]{0} parameter(1)
  %add.97 = c128[3]{0} add(c128[3]{0} %multiply.96, c128[3]{0} %param_1.9), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.105 = f64[3]{0} real(c128[3]{0} %add.97), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.105 = f64[3]{0} imag(c128[3]{0} %add.97), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.75 = f64[3]{0} negate(f64[3]{0} %imag.105), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.73 = c128[3]{0} complex(f64[3]{0} %real.105, f64[3]{0} %negate.75), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %subtract.12 = c128[3]{0} subtract(c128[3]{0} %param_0.3, c128[3]{0} %complex.73), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/sub" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.3 (param_0.6: c128[3], param_1.13: c128[3]) -> c128[3] {
  %param_0.6 = c128[3]{0} parameter(0)
  %param_1.13 = c128[3]{0} parameter(1)
  %add.98 = c128[3]{0} add(c128[3]{0} %param_0.6, c128[3]{0} %param_1.13), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.106 = f64[3]{0} real(c128[3]{0} %add.98), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.106 = f64[3]{0} imag(c128[3]{0} %add.98), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.76 = f64[3]{0} negate(f64[3]{0} %imag.106), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.74 = c128[3]{0} complex(f64[3]{0} %real.106, f64[3]{0} %negate.76), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.4 (param_0.7: c128[3], param_1.16: c128[3], param_2.12: c128[], param_3.5: c128[], param_4.8: c128[]) -> c128[3] {
  %param_0.7 = c128[3]{0} parameter(0)
  %param_4.8 = c128[] parameter(4)
  %abs.36 = f64[] abs(c128[] %param_4.8), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %convert.35 = c128[] convert(f64[] %abs.36), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.108 = f64[] real(c128[] %convert.35), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.76.clone.4 = c128[] constant((6.6613381477509392e-14, 0))
  %param_3.5 = c128[] parameter(3)
  %multiply.98 = c128[] multiply(c128[] %constant.76.clone.4, c128[] %param_3.5), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.107 = f64[] real(c128[] %multiply.98), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.77 = pred[] compare(f64[] %real.108, f64[] %real.107), direction=EQ, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/eq" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.108 = f64[] imag(c128[] %convert.35), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.107 = f64[] imag(c128[] %multiply.98), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.76 = pred[] compare(f64[] %imag.108, f64[] %imag.107), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.75 = pred[] compare(f64[] %real.108, f64[] %real.107), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %select.28 = pred[] select(pred[] %compare.77, pred[] %compare.76, pred[] %compare.75), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/select_n" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_2.12 = c128[] parameter(2)
  %constant.77.clone.4 = c128[] constant((nan, 0))
  %select.27 = c128[] select(pred[] %select.28, c128[] %param_2.12, c128[] %constant.77.clone.4), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/jit(_where)/select_n" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_misc.py" source_line=18}
  %broadcast.68 = c128[3]{0} broadcast(c128[] %select.27), dimensions={}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.16 = c128[3]{0} parameter(1)
  %multiply.97 = c128[3]{0} multiply(c128[3]{0} %broadcast.68, c128[3]{0} %param_1.16), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %add.99 = c128[3]{0} add(c128[3]{0} %param_0.7, c128[3]{0} %multiply.97), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.5 (param_0.9: c128[3], param_1.20: c128[], param_2.17: c128[], param_3.14: c128[]) -> c128[3] {
  %param_3.14 = c128[] parameter(3)
  %abs.37 = f64[] abs(c128[] %param_3.14), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %convert.36 = c128[] convert(f64[] %abs.37), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.110 = f64[] real(c128[] %convert.36), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.76.clone.5 = c128[] constant((6.6613381477509392e-14, 0))
  %param_2.17 = c128[] parameter(2)
  %multiply.100 = c128[] multiply(c128[] %constant.76.clone.5, c128[] %param_2.17), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.109 = f64[] real(c128[] %multiply.100), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.80 = pred[] compare(f64[] %real.110, f64[] %real.109), direction=EQ, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/eq" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.110 = f64[] imag(c128[] %convert.36), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.109 = f64[] imag(c128[] %multiply.100), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.79 = pred[] compare(f64[] %imag.110, f64[] %imag.109), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.78 = pred[] compare(f64[] %real.110, f64[] %real.109), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %select.30 = pred[] select(pred[] %compare.80, pred[] %compare.79, pred[] %compare.78), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/select_n" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.20 = c128[] parameter(1)
  %constant.77.clone.5 = c128[] constant((nan, 0))
  %select.29 = c128[] select(pred[] %select.30, c128[] %param_1.20, c128[] %constant.77.clone.5), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/jit(_where)/select_n" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_misc.py" source_line=18}
  %broadcast.69 = c128[3]{0} broadcast(c128[] %select.29), dimensions={}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_0.9 = c128[3]{0} parameter(0)
  ROOT %multiply.99 = c128[3]{0} multiply(c128[3]{0} %broadcast.69, c128[3]{0} %param_0.9), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.6 (param_0.11: c128[3], param_1.26: c128[3], param_2.24: c128[3]) -> c128[] {
  %param_2.24 = c128[3]{0} parameter(2)
  %real.112 = f64[3]{0} real(c128[3]{0} %param_2.24), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.112 = f64[3]{0} imag(c128[3]{0} %param_2.24), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.79 = f64[3]{0} negate(f64[3]{0} %imag.112), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.76 = c128[3]{0} complex(f64[3]{0} %real.112, f64[3]{0} %negate.79), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.26 = c128[3]{0} parameter(1)
  %constant.57..sunk.4 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.101 = c128[3]{0} multiply(c128[3]{0} %param_1.26, c128[3]{0} %constant.57..sunk.4), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %param_0.11 = c128[3]{0} parameter(0)
  %add.100 = c128[3]{0} add(c128[3]{0} %multiply.101, c128[3]{0} %param_0.11), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.111 = f64[3]{0} real(c128[3]{0} %add.100), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.111 = f64[3]{0} imag(c128[3]{0} %add.100), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.78 = f64[3]{0} negate(f64[3]{0} %imag.111), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.75 = c128[3]{0} complex(f64[3]{0} %real.111, f64[3]{0} %negate.78), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %dot.121 = c128[] dot(c128[3]{0} %complex.76, c128[3]{0} %complex.75), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.7 (param_0.14: c128[3], param_1.30: c128[3]) -> c128[3] {
  %param_0.14 = c128[3]{0} parameter(0)
  %param_1.30 = c128[3]{0} parameter(1)
  %add.101 = c128[3]{0} add(c128[3]{0} %param_0.14, c128[3]{0} %param_1.30), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.113 = f64[3]{0} real(c128[3]{0} %add.101), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.113 = f64[3]{0} imag(c128[3]{0} %add.101), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.80 = f64[3]{0} negate(f64[3]{0} %imag.113), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.77 = c128[3]{0} complex(f64[3]{0} %real.113, f64[3]{0} %negate.80), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%wide.region_0.8.clone.clone.clone (wide.arg_tuple.10: (c128[3], c128[3], c128[3], c128[3], c128[], /*index=5*/s64[], f64[3], c128[3])) -> (c128[3], c128[3], c128[3], c128[3], c128[], /*index=5*/s64[], f64[3], c128[3]) {
  %wide.arg_tuple.10 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) parameter(0)
  %get-tuple-element.390 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.10), index=3
  %copy.9 = c128[3]{0} copy(c128[3]{0} %get-tuple-element.390)
  %get-tuple-element.391 = c128[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.10), index=4
  %copy.10 = c128[] copy(c128[] %get-tuple-element.391)
  %constant.58..sunk.2 = c128[3,3]{1,0} constant({ { (-3.4683985041370184, 0.2818515524340488), (-2.0531999581789173, 0.76532647668268594), (5.269823805569831, 3.5613196166646359) }, { (-2.559036532612764, -0.3698252257987209), (-0.25420681272147494, -1.8022993744788929), (1.667097371428415, 2.7456472301998929) }, { (1.3575242846983384, -4.1063133419096447), (1.4836047923312523, -1.9767224256595632), (-6.86256834124183, -0.81498779940376331) } })
  %dot.100 = c128[3]{0} dot(c128[3,3]{1,0} %constant.58..sunk.2, c128[3]{0} %copy.9), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %constant.7..sunk.6 = c128[3,3]{1,0} constant({ { (-0.35961650795202704, -0.3574244167201307), (0.16636708257665359, 0.13263255633488857), (1.27318783450939, 0.88189620886301057) }, { (0.35700332955161357, 0.18796015296329902), (-0.837553199539162, -0.78027940540578256), (0.20127147836679504, 0.60223804844342244) }, { (0.58774655732207071, 0.46419954874803704), (0.094338355650602168, -0.28282809935266839), (0.73162017785689926, -0.0642288464334354) } })
  %constant.57..sunk.2 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.79 = c128[3]{0} multiply(c128[3]{0} %copy.9, c128[3]{0} %constant.57..sunk.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.101 = c128[3]{0} dot(c128[3,3]{1,0} %constant.7..sunk.6, c128[3]{0} %multiply.79), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.7 = c128[3]{0} fusion(c128[3]{0} %dot.100, c128[3]{0} %dot.101), kind=kLoop, calls=%fused_computation.7, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %dot.103 = c128[3]{0} dot(c128[3]{0} %fusion.7, c128[3,3]{1,0} %constant.58..sunk.2), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.102 = c128[3]{0} dot(c128[3]{0} %fusion.7, c128[3,3]{1,0} %constant.7..sunk.6), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.6 = c128[] fusion(c128[3]{0} %dot.103, c128[3]{0} %dot.102, c128[3]{0} %copy.9), kind=kLoop, calls=%fused_computation.6, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.26 = c128[] divide(c128[] %copy.10, c128[] %fusion.6), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion.5 = c128[3]{0} fusion(c128[3]{0} %copy.9, c128[] %divide.26, c128[] %copy.10, c128[] %fusion.6), kind=kLoop, calls=%fused_computation.5, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.388 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.10), index=1
  %fusion.4 = c128[3]{0} fusion(c128[3]{0} %get-tuple-element.388, c128[3]{0} %copy.9, c128[] %divide.26, c128[] %copy.10, c128[] %fusion.6), kind=kLoop, calls=%fused_computation.4, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.413 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.10), index=7
  %dot.105 = c128[3]{0} dot(c128[3,3]{1,0} %constant.58..sunk.2, c128[3]{0} %fusion.4), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %multiply.83 = c128[3]{0} multiply(c128[3]{0} %fusion.4, c128[3]{0} %constant.57..sunk.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.106 = c128[3]{0} dot(c128[3,3]{1,0} %constant.7..sunk.6, c128[3]{0} %multiply.83), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.3 = c128[3]{0} fusion(c128[3]{0} %dot.105, c128[3]{0} %dot.106), kind=kLoop, calls=%fused_computation.3, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %dot.108 = c128[3]{0} dot(c128[3]{0} %fusion.3, c128[3,3]{1,0} %constant.58..sunk.2), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.107 = c128[3]{0} dot(c128[3]{0} %fusion.3, c128[3,3]{1,0} %constant.7..sunk.6), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.2 = c128[3]{0} fusion(c128[3]{0} %get-tuple-element.413, c128[3]{0} %dot.108, c128[3]{0} %dot.107), kind=kLoop, calls=%fused_computation.2, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/sub" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion.1 = c128[] fusion(c128[3]{0} %fusion.2), kind=kLoop, calls=%fused_computation.1, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.27 = c128[] divide(c128[] %fusion.1, c128[] %copy.10), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion = c128[3]{0} fusion(c128[3]{0} %fusion.2, c128[3]{0} %copy.9, c128[] %divide.27), kind=kLoop, calls=%fused_computation, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.392 = s64[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.10), index=5
  %constant.156 = s64[] constant(1)
  %add.86 = s64[] add(s64[] %get-tuple-element.392, s64[] %constant.156), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.401 = f64[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.10), index=6
  ROOT %tuple.35 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) tuple(c128[3]{0} %fusion.5, c128[3]{0} %fusion.4, c128[3]{0} %fusion.2, c128[3]{0} %fusion, c128[] %fusion.1, /*index=5*/s64[] %add.86, f64[3]{0} %get-tuple-element.401, c128[3]{0} %get-tuple-element.413)
}

%region_3.94 (Arg_0.95: f64[], Arg_1.96: f64[]) -> f64[] {
  %Arg_0.95 = f64[] parameter(0)
  %Arg_1.96 = f64[] parameter(1)
  ROOT %maximum.97 = f64[] maximum(f64[] %Arg_0.95, f64[] %Arg_1.96), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%region_2.90 (Arg_0.91: f64[], Arg_1.92: f64[]) -> f64[] {
  %Arg_0.91 = f64[] parameter(0)
  %Arg_1.92 = f64[] parameter(1)
  ROOT %maximum.93 = f64[] maximum(f64[] %Arg_0.91, f64[] %Arg_1.92), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.8 (param_0.16: c128[3], param_1.36: c128[3], param_2.31: c128[3], param_3.27: f64[3], param_4.25: s64[], param_5.23: c128[]) -> pred[] {
  %param_5.23 = c128[] parameter(5)
  %real.114 = f64[] real(c128[] %param_5.23), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.171 = f64[] constant(0)
  %compare.86 = pred[] compare(f64[] %real.114, f64[] %constant.171), direction=EQ, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/eq" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.114 = f64[] imag(c128[] %param_5.23), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.85 = pred[] compare(f64[] %imag.114, f64[] %constant.171), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.84 = pred[] compare(f64[] %real.114, f64[] %constant.171), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %select.31 = pred[] select(pred[] %compare.86, pred[] %compare.85, pred[] %compare.84), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/select_n" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_4.25 = s64[] parameter(4)
  %constant.170 = s64[] constant(30)
  %compare.83 = pred[] compare(s64[] %param_4.25, s64[] %constant.170), direction=LT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/lt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %and.17 = pred[] and(pred[] %select.31, pred[] %compare.83), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/and" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_2.31 = c128[3]{0} parameter(2)
  %param_3.27 = f64[3]{0} parameter(3)
  %convert.38 = c128[3]{0} convert(f64[3]{0} %param_3.27), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.33 = c128[3]{0} divide(c128[3]{0} %param_2.31, c128[3]{0} %convert.38), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %abs.40 = f64[3]{0} abs(c128[3]{0} %divide.33), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.169 = f64[] constant(-inf)
  %reduce.17 = f64[] reduce(f64[3]{0} %abs.40, f64[] %constant.169), dimensions={0}, to_apply=%region_2.90, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.168 = f64[] constant(1)
  %compare.82 = pred[] compare(f64[] %reduce.17, f64[] %constant.168), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_0.16 = c128[3]{0} parameter(0)
  %param_1.36 = c128[3]{0} parameter(1)
  %abs.39 = f64[3]{0} abs(c128[3]{0} %param_1.36), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.167 = f64[] constant(1e-12)
  %broadcast.70 = f64[3]{0} broadcast(f64[] %constant.167), dimensions={}
  %multiply.102 = f64[3]{0} multiply(f64[3]{0} %abs.39, f64[3]{0} %broadcast.70), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %add.102 = f64[3]{0} add(f64[3]{0} %multiply.102, f64[3]{0} %broadcast.70), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %convert.37 = c128[3]{0} convert(f64[3]{0} %add.102), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.32 = c128[3]{0} divide(c128[3]{0} %param_0.16, c128[3]{0} %convert.37), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %abs.38 = f64[3]{0} abs(c128[3]{0} %divide.32), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %reduce.16 = f64[] reduce(f64[3]{0} %abs.38, f64[] %constant.169), dimensions={0}, to_apply=%region_3.94, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.81 = pred[] compare(f64[] %reduce.16, f64[] %constant.168), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %or.8 = pred[] or(pred[] %compare.82, pred[] %compare.81), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/or" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %and.16 = pred[] and(pred[] %and.17, pred[] %or.8), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/and" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%wide.region_1.98.clone.clone.clone (wide.arg_tuple.8: (c128[3], c128[3], c128[3], c128[3], c128[], /*index=5*/s64[], f64[3], c128[3])) -> pred[] {
  %wide.arg_tuple.8 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) parameter(0)
  %get-tuple-element.316 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.8), index=0
  %get-tuple-element.317 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.8), index=1
  %get-tuple-element.318 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.8), index=2
  %get-tuple-element.321 = f64[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.8), index=6
  %get-tuple-element.320 = s64[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.8), index=5
  %get-tuple-element.319 = c128[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.8), index=4
  ROOT %fusion.8 = pred[] fusion(c128[3]{0} %get-tuple-element.316, c128[3]{0} %get-tuple-element.317, c128[3]{0} %get-tuple-element.318, f64[3]{0} %get-tuple-element.321, s64[] %get-tuple-element.320, /*index=5*/c128[] %get-tuple-element.319), kind=kLoop, calls=%fused_computation.8, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/and" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.9 (param_0.17: c128[3], param_1.39: c128[3], param_2.33: c128[]) -> c128[3] {
  %param_0.17 = c128[3]{0} parameter(0)
  %param_2.33 = c128[] parameter(2)
  %broadcast.71 = c128[3]{0} broadcast(c128[] %param_2.33), dimensions={}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.39 = c128[3]{0} parameter(1)
  %multiply.103 = c128[3]{0} multiply(c128[3]{0} %broadcast.71, c128[3]{0} %param_1.39), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %add.103 = c128[3]{0} add(c128[3]{0} %param_0.17, c128[3]{0} %multiply.103), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.10 (param_0.19: c128[3]) -> c128[] {
  %param_0.19 = c128[3]{0} parameter(0)
  %real.115 = f64[3]{0} real(c128[3]{0} %param_0.19), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.115 = f64[3]{0} imag(c128[3]{0} %param_0.19), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.81 = f64[3]{0} negate(f64[3]{0} %imag.115), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.79 = c128[3]{0} complex(f64[3]{0} %real.115, f64[3]{0} %negate.81), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %dot.122 = c128[] dot(c128[3]{0} %complex.79, c128[3]{0} %param_0.19), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.11 (param_0.20: c128[3], param_1.46: c128[3], param_2.40: c128[3]) -> c128[3] {
  %param_0.20 = c128[3]{0} parameter(0)
  %param_2.40 = c128[3]{0} parameter(2)
  %constant.78..sunk.3 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.104 = c128[3]{0} multiply(c128[3]{0} %param_2.40, c128[3]{0} %constant.78..sunk.3), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %param_1.46 = c128[3]{0} parameter(1)
  %add.104 = c128[3]{0} add(c128[3]{0} %multiply.104, c128[3]{0} %param_1.46), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.116 = f64[3]{0} real(c128[3]{0} %add.104), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.116 = f64[3]{0} imag(c128[3]{0} %add.104), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.83 = f64[3]{0} negate(f64[3]{0} %imag.116), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.80 = c128[3]{0} complex(f64[3]{0} %real.116, f64[3]{0} %negate.83), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %subtract.13 = c128[3]{0} subtract(c128[3]{0} %param_0.20, c128[3]{0} %complex.80), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/sub" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.12 (param_0.23: c128[3], param_1.50: c128[3]) -> c128[3] {
  %param_0.23 = c128[3]{0} parameter(0)
  %param_1.50 = c128[3]{0} parameter(1)
  %add.105 = c128[3]{0} add(c128[3]{0} %param_0.23, c128[3]{0} %param_1.50), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.119 = f64[3]{0} real(c128[3]{0} %add.105), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.117 = f64[3]{0} imag(c128[3]{0} %add.105), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.84 = f64[3]{0} negate(f64[3]{0} %imag.117), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.81 = c128[3]{0} complex(f64[3]{0} %real.119, f64[3]{0} %negate.84), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.13 (param_0.24: c128[3], param_1.53: c128[3], param_2.44: c128[], param_3.33: c128[], param_4.34: c128[]) -> c128[3] {
  %param_0.24 = c128[3]{0} parameter(0)
  %param_4.34 = c128[] parameter(4)
  %abs.41 = f64[] abs(c128[] %param_4.34), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %convert.39 = c128[] convert(f64[] %abs.41), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.121 = f64[] real(c128[] %convert.39), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.97.clone.4 = c128[] constant((6.6613381477509392e-14, 0))
  %param_3.33 = c128[] parameter(3)
  %multiply.106 = c128[] multiply(c128[] %constant.97.clone.4, c128[] %param_3.33), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.120 = f64[] real(c128[] %multiply.106), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.89 = pred[] compare(f64[] %real.121, f64[] %real.120), direction=EQ, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/eq" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.119 = f64[] imag(c128[] %convert.39), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.118 = f64[] imag(c128[] %multiply.106), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.88 = pred[] compare(f64[] %imag.119, f64[] %imag.118), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.87 = pred[] compare(f64[] %real.121, f64[] %real.120), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %select.33 = pred[] select(pred[] %compare.89, pred[] %compare.88, pred[] %compare.87), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/select_n" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_2.44 = c128[] parameter(2)
  %constant.98.clone.4 = c128[] constant((nan, 0))
  %select.32 = c128[] select(pred[] %select.33, c128[] %param_2.44, c128[] %constant.98.clone.4), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/jit(_where)/select_n" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_misc.py" source_line=18}
  %broadcast.72 = c128[3]{0} broadcast(c128[] %select.32), dimensions={}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.53 = c128[3]{0} parameter(1)
  %multiply.105 = c128[3]{0} multiply(c128[3]{0} %broadcast.72, c128[3]{0} %param_1.53), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %add.106 = c128[3]{0} add(c128[3]{0} %param_0.24, c128[3]{0} %multiply.105), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.14 (param_0.26: c128[3], param_1.57: c128[], param_2.49: c128[], param_3.42: c128[]) -> c128[3] {
  %param_3.42 = c128[] parameter(3)
  %abs.42 = f64[] abs(c128[] %param_3.42), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %convert.40 = c128[] convert(f64[] %abs.42), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.123 = f64[] real(c128[] %convert.40), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.97.clone.5 = c128[] constant((6.6613381477509392e-14, 0))
  %param_2.49 = c128[] parameter(2)
  %multiply.108 = c128[] multiply(c128[] %constant.97.clone.5, c128[] %param_2.49), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.122 = f64[] real(c128[] %multiply.108), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.92 = pred[] compare(f64[] %real.123, f64[] %real.122), direction=EQ, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/eq" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.123 = f64[] imag(c128[] %convert.40), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.122 = f64[] imag(c128[] %multiply.108), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.91 = pred[] compare(f64[] %imag.123, f64[] %imag.122), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.90 = pred[] compare(f64[] %real.123, f64[] %real.122), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %select.35 = pred[] select(pred[] %compare.92, pred[] %compare.91, pred[] %compare.90), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/select_n" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.57 = c128[] parameter(1)
  %constant.98.clone.5 = c128[] constant((nan, 0))
  %select.34 = c128[] select(pred[] %select.35, c128[] %param_1.57, c128[] %constant.98.clone.5), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/jit(_where)/select_n" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_misc.py" source_line=18}
  %broadcast.73 = c128[3]{0} broadcast(c128[] %select.34), dimensions={}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_0.26 = c128[3]{0} parameter(0)
  ROOT %multiply.107 = c128[3]{0} multiply(c128[3]{0} %broadcast.73, c128[3]{0} %param_0.26), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.15 (param_0.28: c128[3], param_1.63: c128[3], param_2.56: c128[3]) -> c128[] {
  %param_2.56 = c128[3]{0} parameter(2)
  %real.125 = f64[3]{0} real(c128[3]{0} %param_2.56), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.125 = f64[3]{0} imag(c128[3]{0} %param_2.56), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.86 = f64[3]{0} negate(f64[3]{0} %imag.125), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.84 = c128[3]{0} complex(f64[3]{0} %real.125, f64[3]{0} %negate.86), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_1.63 = c128[3]{0} parameter(1)
  %constant.78..sunk.4 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.109 = c128[3]{0} multiply(c128[3]{0} %param_1.63, c128[3]{0} %constant.78..sunk.4), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %param_0.28 = c128[3]{0} parameter(0)
  %add.107 = c128[3]{0} add(c128[3]{0} %multiply.109, c128[3]{0} %param_0.28), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.124 = f64[3]{0} real(c128[3]{0} %add.107), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.124 = f64[3]{0} imag(c128[3]{0} %add.107), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.85 = f64[3]{0} negate(f64[3]{0} %imag.124), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %complex.82 = c128[3]{0} complex(f64[3]{0} %real.124, f64[3]{0} %negate.85), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %dot.123 = c128[] dot(c128[3]{0} %complex.84, c128[3]{0} %complex.82), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.16 (param_0.31: c128[3], param_1.67: c128[3]) -> c128[3] {
  %param_0.31 = c128[3]{0} parameter(0)
  %param_1.67 = c128[3]{0} parameter(1)
  %add.108 = c128[3]{0} add(c128[3]{0} %param_0.31, c128[3]{0} %param_1.67), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %real.126 = f64[3]{0} real(c128[3]{0} %add.108), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.126 = f64[3]{0} imag(c128[3]{0} %add.108), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.87 = f64[3]{0} negate(f64[3]{0} %imag.126), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.85 = c128[3]{0} complex(f64[3]{0} %real.126, f64[3]{0} %negate.87), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%wide.region_4.148.clone.clone.clone (wide.arg_tuple.12: (c128[3], c128[3], c128[3], c128[3], c128[], /*index=5*/s64[], f64[3], c128[3])) -> (c128[3], c128[3], c128[3], c128[3], c128[], /*index=5*/s64[], f64[3], c128[3]) {
  %wide.arg_tuple.12 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) parameter(0)
  %get-tuple-element.427 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.12), index=3
  %copy.27 = c128[3]{0} copy(c128[3]{0} %get-tuple-element.427)
  %get-tuple-element.430 = c128[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.12), index=4
  %copy.28 = c128[] copy(c128[] %get-tuple-element.430)
  %constant.79..sunk.2 = c128[3,3]{1,0} constant({ { (-3.4683985041370184, 0.2818515524340488), (-2.0531999581789173, 0.76532647668268594), (5.269823805569831, 3.5613196166646359) }, { (-2.559036532612764, -0.3698252257987209), (-0.25420681272147494, -1.8022993744788929), (1.667097371428415, 2.7456472301998929) }, { (1.3575242846983384, -4.1063133419096447), (1.4836047923312523, -1.9767224256595632), (-6.86256834124183, -0.81498779940376331) } })
  %dot.110 = c128[3]{0} dot(c128[3,3]{1,0} %constant.79..sunk.2, c128[3]{0} %copy.27), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %constant.7..sunk.7 = c128[3,3]{1,0} constant({ { (-0.35961650795202704, -0.3574244167201307), (0.16636708257665359, 0.13263255633488857), (1.27318783450939, 0.88189620886301057) }, { (0.35700332955161357, 0.18796015296329902), (-0.837553199539162, -0.78027940540578256), (0.20127147836679504, 0.60223804844342244) }, { (0.58774655732207071, 0.46419954874803704), (0.094338355650602168, -0.28282809935266839), (0.73162017785689926, -0.0642288464334354) } })
  %constant.78..sunk.2 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.88 = c128[3]{0} multiply(c128[3]{0} %copy.27, c128[3]{0} %constant.78..sunk.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.111 = c128[3]{0} dot(c128[3,3]{1,0} %constant.7..sunk.7, c128[3]{0} %multiply.88), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.16 = c128[3]{0} fusion(c128[3]{0} %dot.110, c128[3]{0} %dot.111), kind=kLoop, calls=%fused_computation.16, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %dot.113 = c128[3]{0} dot(c128[3]{0} %fusion.16, c128[3,3]{1,0} %constant.79..sunk.2), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.112 = c128[3]{0} dot(c128[3]{0} %fusion.16, c128[3,3]{1,0} %constant.7..sunk.7), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.15 = c128[] fusion(c128[3]{0} %dot.113, c128[3]{0} %dot.112, c128[3]{0} %copy.27), kind=kLoop, calls=%fused_computation.15, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.30 = c128[] divide(c128[] %copy.28, c128[] %fusion.15), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion.14 = c128[3]{0} fusion(c128[3]{0} %copy.27, c128[] %divide.30, c128[] %copy.28, c128[] %fusion.15), kind=kLoop, calls=%fused_computation.14, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.423 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.12), index=1
  %fusion.13 = c128[3]{0} fusion(c128[3]{0} %get-tuple-element.423, c128[3]{0} %copy.27, c128[] %divide.30, c128[] %copy.28, c128[] %fusion.15), kind=kLoop, calls=%fused_computation.13, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.441 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.12), index=7
  %dot.115 = c128[3]{0} dot(c128[3,3]{1,0} %constant.79..sunk.2, c128[3]{0} %fusion.13), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %multiply.92 = c128[3]{0} multiply(c128[3]{0} %fusion.13, c128[3]{0} %constant.78..sunk.2), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.116 = c128[3]{0} dot(c128[3,3]{1,0} %constant.7..sunk.7, c128[3]{0} %multiply.92), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.12 = c128[3]{0} fusion(c128[3]{0} %dot.115, c128[3]{0} %dot.116), kind=kLoop, calls=%fused_computation.12, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %dot.118 = c128[3]{0} dot(c128[3]{0} %fusion.12, c128[3,3]{1,0} %constant.79..sunk.2), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.117 = c128[3]{0} dot(c128[3]{0} %fusion.12, c128[3,3]{1,0} %constant.7..sunk.7), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.11 = c128[3]{0} fusion(c128[3]{0} %get-tuple-element.441, c128[3]{0} %dot.118, c128[3]{0} %dot.117), kind=kLoop, calls=%fused_computation.11, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/sub" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion.10 = c128[] fusion(c128[3]{0} %fusion.11), kind=kLoop, calls=%fused_computation.10, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.31 = c128[] divide(c128[] %fusion.10, c128[] %copy.28), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion.9 = c128[3]{0} fusion(c128[3]{0} %fusion.11, c128[3]{0} %copy.27, c128[] %divide.31), kind=kLoop, calls=%fused_computation.9, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.431 = s64[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.12), index=5
  %constant.166 = s64[] constant(1)
  %add.95 = s64[] add(s64[] %get-tuple-element.431, s64[] %constant.166), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/body/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %get-tuple-element.440 = f64[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.12), index=6
  ROOT %tuple.38 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) tuple(c128[3]{0} %fusion.14, c128[3]{0} %fusion.13, c128[3]{0} %fusion.11, c128[3]{0} %fusion.9, c128[] %fusion.10, /*index=5*/s64[] %add.95, f64[3]{0} %get-tuple-element.440, c128[3]{0} %get-tuple-element.441)
}

%region_7.234 (Arg_0.235: f64[], Arg_1.236: f64[]) -> f64[] {
  %Arg_0.235 = f64[] parameter(0)
  %Arg_1.236 = f64[] parameter(1)
  ROOT %maximum.237 = f64[] maximum(f64[] %Arg_0.235, f64[] %Arg_1.236), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%region_6.230 (Arg_0.231: f64[], Arg_1.232: f64[]) -> f64[] {
  %Arg_0.231 = f64[] parameter(0)
  %Arg_1.232 = f64[] parameter(1)
  ROOT %maximum.233 = f64[] maximum(f64[] %Arg_0.231, f64[] %Arg_1.232), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.17 (param_0.33: c128[3], param_1.73: c128[3], param_2.63: c128[3], param_3.55: f64[3], param_4.51: s64[], param_5.47: c128[]) -> pred[] {
  %param_5.47 = c128[] parameter(5)
  %real.127 = f64[] real(c128[] %param_5.47), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.176 = f64[] constant(0)
  %compare.98 = pred[] compare(f64[] %real.127, f64[] %constant.176), direction=EQ, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/eq" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.127 = f64[] imag(c128[] %param_5.47), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.97 = pred[] compare(f64[] %imag.127, f64[] %constant.176), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.96 = pred[] compare(f64[] %real.127, f64[] %constant.176), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %select.36 = pred[] select(pred[] %compare.98, pred[] %compare.97, pred[] %compare.96), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/select_n" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_4.51 = s64[] parameter(4)
  %constant.175 = s64[] constant(30)
  %compare.95 = pred[] compare(s64[] %param_4.51, s64[] %constant.175), direction=LT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/lt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %and.19 = pred[] and(pred[] %select.36, pred[] %compare.95), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/and" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_2.63 = c128[3]{0} parameter(2)
  %param_3.55 = f64[3]{0} parameter(3)
  %convert.42 = c128[3]{0} convert(f64[3]{0} %param_3.55), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.35 = c128[3]{0} divide(c128[3]{0} %param_2.63, c128[3]{0} %convert.42), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %abs.45 = f64[3]{0} abs(c128[3]{0} %divide.35), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.174 = f64[] constant(-inf)
  %reduce.19 = f64[] reduce(f64[3]{0} %abs.45, f64[] %constant.174), dimensions={0}, to_apply=%region_6.230, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.173 = f64[] constant(1)
  %compare.94 = pred[] compare(f64[] %reduce.19, f64[] %constant.173), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %param_0.33 = c128[3]{0} parameter(0)
  %param_1.73 = c128[3]{0} parameter(1)
  %abs.44 = f64[3]{0} abs(c128[3]{0} %param_1.73), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.172 = f64[] constant(1e-12)
  %broadcast.74 = f64[3]{0} broadcast(f64[] %constant.172), dimensions={}
  %multiply.110 = f64[3]{0} multiply(f64[3]{0} %abs.44, f64[3]{0} %broadcast.74), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %add.109 = f64[3]{0} add(f64[3]{0} %multiply.110, f64[3]{0} %broadcast.74), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %convert.41 = c128[3]{0} convert(f64[3]{0} %add.109), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/convert_element_type[new_dtype=complex128 weak_type=False]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %divide.34 = c128[3]{0} divide(c128[3]{0} %param_0.33, c128[3]{0} %convert.41), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/div" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %abs.43 = f64[3]{0} abs(c128[3]{0} %divide.34), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %reduce.18 = f64[] reduce(f64[3]{0} %abs.43, f64[] %constant.174), dimensions={0}, to_apply=%region_7.234, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/reduce_max[axes=(0,)]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %compare.93 = pred[] compare(f64[] %reduce.18, f64[] %constant.173), direction=GT, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/gt" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %or.9 = pred[] or(pred[] %compare.94, pred[] %compare.93), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/or" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %and.18 = pred[] and(pred[] %and.19, pred[] %or.9), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/and" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%wide.region_5.238.clone.clone.clone (wide.arg_tuple.11: (c128[3], c128[3], c128[3], c128[3], c128[], /*index=5*/s64[], f64[3], c128[3])) -> pred[] {
  %wide.arg_tuple.11 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) parameter(0)
  %get-tuple-element.357 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.11), index=0
  %get-tuple-element.358 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.11), index=1
  %get-tuple-element.359 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.11), index=2
  %get-tuple-element.362 = f64[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.11), index=6
  %get-tuple-element.361 = s64[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.11), index=5
  %get-tuple-element.360 = c128[] get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %wide.arg_tuple.11), index=4
  ROOT %fusion.17 = pred[] fusion(c128[3]{0} %get-tuple-element.357, c128[3]{0} %get-tuple-element.358, c128[3]{0} %get-tuple-element.359, f64[3]{0} %get-tuple-element.362, s64[] %get-tuple-element.361, /*index=5*/c128[] %get-tuple-element.360), kind=kLoop, calls=%fused_computation.17, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while/cond/and" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.18 (param_0.36: c128[3]) -> f64[3] {
  %param_0.36 = c128[3]{0} parameter(0)
  %abs.47 = f64[3]{0} abs(c128[3]{0} %param_0.36), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.177 = f64[] constant(1e-12)
  %broadcast.75 = f64[3]{0} broadcast(f64[] %constant.177), dimensions={}
  %multiply.111 = f64[3]{0} multiply(f64[3]{0} %abs.47, f64[3]{0} %broadcast.75), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %add.110 = f64[3]{0} add(f64[3]{0} %multiply.111, f64[3]{0} %broadcast.75), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.19 (param_0.38: c128[3]) -> c128[3] {
  %param_0.38 = c128[3]{0} parameter(0)
  %real.128 = f64[3]{0} real(c128[3]{0} %param_0.38), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.128 = f64[3]{0} imag(c128[3]{0} %param_0.38), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.88 = f64[3]{0} negate(f64[3]{0} %imag.128), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.86 = c128[3]{0} complex(f64[3]{0} %real.128, f64[3]{0} %negate.88), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.20 (param_0.40: c128[3], param_1.82: c128[3]) -> c128[3] {
  %param_1.82 = c128[3]{0} parameter(1)
  %constant.178 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.112 = c128[3]{0} multiply(c128[3]{0} %param_1.82, c128[3]{0} %constant.178), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %param_0.40 = c128[3]{0} parameter(0)
  ROOT %add.111 = c128[3]{0} add(c128[3]{0} %multiply.112, c128[3]{0} %param_0.40), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
}

%fused_computation.21 (param_0.44: c128[3]) -> c128[3] {
  %param_0.44 = c128[3]{0} parameter(0)
  %negate.90 = c128[3]{0} negate(c128[3]{0} %param_0.44), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.179 = c128[3]{0} constant({(0.096614635547677963, -0.396795781037413), (-0.30647750727088507, 0.24441113824731425), (0.13243539107890515, 1.1782402344524892)}), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %add.112 = c128[3]{0} add(c128[3]{0} %negate.90, c128[3]{0} %constant.179), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %real.129 = f64[3]{0} real(c128[3]{0} %add.112), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.129 = f64[3]{0} imag(c128[3]{0} %add.112), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.89 = f64[3]{0} negate(f64[3]{0} %imag.129), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.87 = c128[3]{0} complex(f64[3]{0} %real.129, f64[3]{0} %negate.89), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.22 (param_0.48: c128[3]) -> f64[3] {
  %param_0.48 = c128[3]{0} parameter(0)
  %abs.48 = f64[3]{0} abs(c128[3]{0} %param_0.48), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/abs" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.180 = f64[] constant(1e-12)
  %broadcast.76 = f64[3]{0} broadcast(f64[] %constant.180), dimensions={}
  %multiply.113 = f64[3]{0} multiply(f64[3]{0} %abs.48, f64[3]{0} %broadcast.76), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/mul" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %add.113 = f64[3]{0} add(f64[3]{0} %multiply.113, f64[3]{0} %broadcast.76), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.23 (param_0.50: c128[3]) -> c128[3] {
  %param_0.50 = c128[3]{0} parameter(0)
  %real.130 = f64[3]{0} real(c128[3]{0} %param_0.50), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.130 = f64[3]{0} imag(c128[3]{0} %param_0.50), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.91 = f64[3]{0} negate(f64[3]{0} %imag.130), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.88 = c128[3]{0} complex(f64[3]{0} %real.130, f64[3]{0} %negate.91), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

%fused_computation.24 (param_0.52: c128[3], param_1.94: c128[3]) -> c128[3] {
  %param_1.94 = c128[3]{0} parameter(1)
  %constant.181 = c128[3]{0} constant({(1.8662642516361887, -1.0711323052056121), (0.26333651876420233, -2.397191531077155), (-1.1171098790664813, 1.0158783792828929)})
  %multiply.114 = c128[3]{0} multiply(c128[3]{0} %param_1.94, c128[3]{0} %constant.181), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/mul" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %param_0.52 = c128[3]{0} parameter(0)
  ROOT %add.114 = c128[3]{0} add(c128[3]{0} %multiply.114, c128[3]{0} %param_0.52), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
}

%fused_computation.25 (param_0.54: c128[3]) -> c128[3] {
  %param_0.54 = c128[3]{0} parameter(0)
  %real.131 = f64[3]{0} real(c128[3]{0} %param_0.54), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/real" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %imag.131 = f64[3]{0} imag(c128[3]{0} %param_0.54), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/imag" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %negate.92 = f64[3]{0} negate(f64[3]{0} %imag.131), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/neg" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %complex.89 = c128[3]{0} complex(f64[3]{0} %real.131, f64[3]{0} %negate.92), metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
}

ENTRY %main.431 (Arg_0.1: c128[3]) -> (c128[3], c128[3]) {
  %constant.5 = c128[] constant((inf, 0))
  %broadcast.4 = c128[3]{0} broadcast(c128[] %constant.5), dimensions={}
  %copy = c128[3]{0} copy(c128[3]{0} %broadcast.4)
  %constant.6 = c128[] constant((0, 0))
  %broadcast.5 = c128[3]{0} broadcast(c128[] %constant.6), dimensions={}
  %copy.1 = c128[3]{0} copy(c128[3]{0} %broadcast.5)
  %Arg_0.1 = c128[3]{0} parameter(0), sharding={replicated}
  %fusion.25 = c128[3]{0} fusion(c128[3]{0} %Arg_0.1), kind=kLoop, calls=%fused_computation.25, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.58 = c128[3,3]{0,1} constant({ { (-3.4683985041370184, 0.2818515524340488), (-2.0531999581789173, 0.76532647668268594), (5.269823805569831, 3.5613196166646359) }, { (-2.559036532612764, -0.3698252257987209), (-0.25420681272147494, -1.8022993744788929), (1.667097371428415, 2.7456472301998929) }, { (1.3575242846983384, -4.1063133419096447), (1.4836047923312523, -1.9767224256595632), (-6.86256834124183, -0.81498779940376331) } })
  %dot.16 = c128[3]{0} dot(c128[3]{0} %fusion.25, c128[3,3]{0,1} %constant.58), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %constant.7 = c128[3,3]{0,1} constant({ { (-0.35961650795202704, -0.3574244167201307), (0.16636708257665359, 0.13263255633488857), (1.27318783450939, 0.88189620886301057) }, { (0.35700332955161357, 0.18796015296329902), (-0.837553199539162, -0.78027940540578256), (0.20127147836679504, 0.60223804844342244) }, { (0.58774655732207071, 0.46419954874803704), (0.094338355650602168, -0.28282809935266839), (0.73162017785689926, -0.0642288464334354) } })
  %dot.15 = c128[3]{0} dot(c128[3]{0} %fusion.25, c128[3,3]{0,1} %constant.7), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.24 = c128[3]{0} fusion(c128[3]{0} %dot.16, c128[3]{0} %dot.15), kind=kLoop, calls=%fused_computation.24, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.23 = c128[3]{0} fusion(c128[3]{0} %fusion.24), kind=kLoop, calls=%fused_computation.23, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %copy.2 = c128[3]{0} copy(c128[3]{0} %fusion.23)
  %copy.3 = c128[3]{0} copy(c128[3]{0} %fusion.23)
  %dot.21 = c128[] dot(c128[3]{0} %fusion.24, c128[3]{0} %fusion.23), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.12 = s64[] constant(0)
  %copy.36 = s64[] copy(s64[] %constant.12)
  %copy.5 = s64[] copy(s64[] %copy.36)
  %fusion.22 = f64[3]{0} fusion(c128[3]{0} %fusion.23), kind=kLoop, calls=%fused_computation.22, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %tuple.33 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) tuple(c128[3]{0} %copy, c128[3]{0} %copy.1, c128[3]{0} %copy.2, c128[3]{0} %copy.3, c128[] %dot.21, /*index=5*/s64[] %copy.5, f64[3]{0} %fusion.22, c128[3]{0} %fusion.23)
  %while.10 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) while((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %tuple.33), condition=%wide.region_1.98.clone.clone.clone, body=%wide.region_0.8.clone.clone.clone
  %get-tuple-element.428 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %while.10), index=1, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while[cond_nconsts=1 body_nconsts=4]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %constant.15 = c128[3,3]{1,0} constant({ { (-6.6167674638904037, 0), (2.9123017567991316, -0.9126692954898501), (-2.4281555629411122, 0.47152661513864047) }, { (2.9123017567991316, 0.9126692954898501), (-6.4861884029973975, 0), (3.8114787200948985, -0.75948861512794119) }, { (-2.4281555629411122, -0.47152661513864047), (3.8114787200948985, 0.75948861512794119), (-7.6184389466625735, 0) } })
  %dot.22 = c128[3]{0} dot(c128[3,3]{1,0} %constant.15, c128[3]{0} %get-tuple-element.428), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((1,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.21 = c128[3]{0} fusion(c128[3]{0} %dot.22), kind=kLoop, calls=%fused_computation.21, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %dot.25 = c128[3]{0} dot(c128[3]{0} %fusion.21, c128[3,3]{0,1} %constant.58), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %dot.23 = c128[3]{0} dot(c128[3]{0} %fusion.21, c128[3,3]{0,1} %constant.7), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.20 = c128[3]{0} fusion(c128[3]{0} %dot.25, c128[3]{0} %dot.23), kind=kLoop, calls=%fused_computation.20, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add_any" source_file="/home/evgeny/PycharmProjects/lineax_bug_mwe/tests/bug_helpers.py" source_line=20}
  %fusion.19 = c128[3]{0} fusion(c128[3]{0} %fusion.20), kind=kLoop, calls=%fused_computation.19, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/complex" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %copy.20 = c128[3]{0} copy(c128[3]{0} %fusion.19)
  %copy.21 = c128[3]{0} copy(c128[3]{0} %fusion.19)
  %dot.31 = c128[] dot(c128[3]{0} %fusion.20, c128[3]{0} %fusion.19), lhs_contracting_dims={0}, rhs_contracting_dims={0}, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/dot_general[dimension_numbers=(((0,), (0,)), ((), ())) precision=None preferred_element_type=complex128]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %fusion.18 = f64[3]{0} fusion(c128[3]{0} %fusion.19), kind=kLoop, calls=%fused_computation.18, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/add" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  %tuple.36 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) tuple(c128[3]{0} %broadcast.4, c128[3]{0} %broadcast.5, c128[3]{0} %copy.20, c128[3]{0} %copy.21, c128[] %dot.31, /*index=5*/s64[] %copy.36, f64[3]{0} %fusion.18, c128[3]{0} %fusion.19)
  %while.11 = (c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) while((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %tuple.36), condition=%wide.region_5.238.clone.clone.clone, body=%wide.region_4.148.clone.clone.clone
  %get-tuple-element.429 = c128[3]{0} get-tuple-element((c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[3]{0}, c128[], /*index=5*/s64[], f64[3]{0}, c128[3]{0}) %while.11), index=1, metadata={op_name="jit(<lambda>)/jit(main)/jit(<lambda>)/jvp(jit(linear_solve))/while[cond_nconsts=1 body_nconsts=4]" source_file="/home/evgeny/.local/lib/python3.11/site-packages/equinox/internal/_primitive.py" source_line=264}
  ROOT %tuple.430 = (c128[3]{0}, c128[3]{0}) tuple(c128[3]{0} %get-tuple-element.428, c128[3]{0} %get-tuple-element.429)
}

